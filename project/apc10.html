---
layout: default
---

<section class="min-h-screen relative bg-top md:bg-left bg-no-repeat bg-contain">
    <div class="container pt-8 lg:pt-16">
      <div class="w-full md:w-1/2 mt-8 lg:mt-16 xxl:mt-32">
        <h1 class="text-2xl sm:text-3xl md:text-4xl xl:text-5xl text-navy mt-2 lg:mt-4">
          Amazon Price Checker ðŸ›’
        </h1>
        <p class="text-lg sm:text-xl md:text-2xl text-navy mt-4">
          Saisissez les 10 URLs des 10 produits que vous souhaitez surveiller sur Amazon
        </p>
        <form role="form" data-toggle="validator">
          <div>
            <input type="url" id="url1" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Votre URL doit commencer par https://www.amazon.fr/" required>
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url2" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url3" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url4" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url5" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url6" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url7" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url8" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url9" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <div>
            <input type="url" id="url10" class="bg-pink-light" style="width:100%" placeholder="https://www.amazon.fr/dp/B084DWG2VQ/" data-error="Please provide a valid Amazon URL" >
            <div class="help-block with-errors"></div>
          </div>
          <input type="hidden" id="userID" data-ms-member="id">
          <button type="submit" class="btn btn-default action-btn" id="btn">Tracker ces produits</button>
        </form>
        <p class="text-lg sm:text-xl md:text-2xl text-navy mt-4">
            <a href="/members/welcome">Retourner au dashboard</a>
        </p>
      </div>
    </div> 
</section>
  
<footer class="bg-navy-light min-h-screen flex flex-col">
  <div class="py-12 lg:py-16 flex-grow banner flex items-center">
    <div class="container md:h-full text-center">
      <h2 class="text-pink text-2xl md:text-3xl xl:text-4xl">
        Amazon Price Checker
      </h2>
      <p class="text-pink-light text-xl md:text-2xl max-w-5xl mt-4 mx-auto mb-16">
        Relax, on garde un oeil sur vos prix ðŸ‘€
      </p>
    </div>
  </div>
</footer>

<script>
window.onload = function(){
    var request = new XMLHttpRequest();
    
    var id = document.getElementById("userID").value;
    
    /*var url1 = document.getElementById("url1").value;
    var url2 = document.getElementById("url2").value;
    var url3 = document.getElementById("url3").value;
    var url4 = document.getElementById("url4").value;
    var url5 = document.getElementById("url5").value;
    var url6 = document.getElementById("url6").value;
    var url7 = document.getElementById("url7").value;
    var url8 = document.getElementById("url8").value;
    var url9 = document.getElementById("url9").value;
    var url10 = document.getElementById("url10").value;*/
    
    request.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            var json = JSON.parse(this.responseText);
            console.log(json);
            
            MemberStack.onReady.then(async function(member) {
                var metaData = member.getMetaData()
                console.log(metaData);
                var rec = member.rec;
                console.log(rec);
            })
            
            for (var i = 0; i < json.records.length; i++) {
            
            var count = i + 1;
            var url = "url" + count;
            var value = document.getElementById(url).value;
            var urlResponse = json.records[i].fields.URL;
            document.getElementById(url).value = urlResponse;
                
            }
            
            /*var url1 = json.records[0].fields.URL;
            document.getElementById("url1").value = url1;
            
            var url2 = json.records[1].fields.URL;
            document.getElementById("url2").value = url2;
            
            var url3 = json.records[2].fields.URL;
            document.getElementById("url3").value = url3;
            
            var url4 = json.records[3].fields.URL;
            document.getElementById("url4").value = url4;
            
            var url5 = json.records[4].fields.URL;
            document.getElementById("url5").value = url5;
            
            var url6 = json.records[5].fields.URL;
            document.getElementById("url6").value = url6;
            
            var url7 = json.records[6].fields.URL;
            document.getElementById("url7").value = url7;
            
            var url8 = json.records[7].fields.URL;
            document.getElementById("url8").value = url8;
            
            var url9 = json.records[8].fields.URL;
            document.getElementById("url9").value = url9;
            
            var url10 = json.records[9].fields.URL;
            document.getElementById("url10").value = url10;*/
        }
    };

    request.open('GET', 'https://api.airtable.com/v0/appNWCk04VryqPCTS/Amazon%20Price%20Checker?maxRecords=10&view=All%20URLs&filterByFormula=%3DAND%28%7BMemberstack%20ID%7D%3D%27' + id + '%27%2C%7BURL%20tracked%3F%7D%29');
    request.setRequestHeader('Authorization', 'Bearer keykvY3PwUzBpmFy2');
    request.send();
}
    
$(document).ready(function() {
    $('#btn').click(function() {
        $.ajax({
        type : 'POST',
        url : 'https://hook.integromat.com/tvp4wlajq3ifo23o0knctemobpbfymws',
        async : false,
        data: {
            url1 : $('#url1').val(),
            url2 : $('#url2').val(),
            url3 : $('#url3').val(),
            url4 : $('#url4').val(),
            url5 : $('#url5').val(),
            url6 : $('#url6').val(),
            url7 : $('#url7').val(),
            url8 : $('#url8').val(),
            url9 : $('#url9').val(),
            url10 : $('#url10').val(),
            userID : $('#userID').val()
        },
        success:function (data) {
            console.log(data);
        },
        error: function(xhr, status, error) {
        // handle error
        }
        });
    });
});
    
/*$(function(){
 //Bootstrap Validator
 /*$('form').validator().on('validated.bs.validator', function(e){
   var target = e.relatedTarget;
      if (target.id == 'url1'){
        $('#url2').prop('disabled', !target.checkValidity());
      } else if (target.id == 'url2'){
        $('#url3').prop('disabled', !target.checkValidity());
      } else if (target.id == 'url3'){
        $('#url4').prop('disabled', !target.checkValidity());
      } else if (target.id == 'url4'){
        $('#url5').prop('disabled', !target.checkValidity());
      } else if (target.id == 'url5'){
        $('#url6').prop('disabled', !target.checkValidity());
      } else if (target.id == 'url6'){
        $('#url7').prop('disabled', !target.checkValidity());
      } else if (target.id == 'url7'){
        $('#url8').prop('disabled', !target.checkValidity());
      } else if (target.id == 'url8'){
        $('#url9').prop('disabled', !target.checkValidity());
      } else if (target.id == 'url9'){
        $('#url10').prop('disabled', !target.checkValidity());
      }
  })
});*/
</script>
